### This file is automatically generated by Michał Mróz
### Because People at QT's headquarters couldn't figure this shit out.
### Do not change

file(GLOB RESOURCE_FILES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} *.png)

qt_add_library(asset_imports STATIC)

qt6_add_qml_module(asset_imports
    URI "asset_imports"
    VERSION 1.0
    RESOURCE_PREFIX "/qt/qml"
    RESOURCES
        ${RESOURCE_FILES}
)

function(find_directories_up_to_depth BASE_DIR OUT_VAR CURRENT_DEPTH MAX_DEPTH)
    if(CURRENT_DEPTH GREATER MAX_DEPTH)
        return()
    endif()

    file(GLOB ALL_ITEMS "${BASE_DIR}/*")
    foreach(ITEM ${ALL_ITEMS})
        if(IS_DIRECTORY ${ITEM})
            list(APPEND ${OUT_VAR} ${ITEM})
            if(CURRENT_DEPTH LESS MAX_DEPTH)
                find_directories_up_to_depth(${ITEM} ${OUT_VAR} ${CURRENT_DEPTH} + 1 ${MAX_DEPTH})
            endif()
        endif()
    endforeach()
    set(${OUT_VAR} ${${OUT_VAR}} PARENT_SCOPE)
endfunction()

find_directories_up_to_depth(${CMAKE_CURRENT_LIST_DIR} DIRECTORIES 1 2)

foreach(DIR ${DIRECTORIES})
    get_filename_component(DIR_NAME ${DIR} NAME)

    file(GLOB_RECURSE QML_FILES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} *.qml)

    file(RELATIVE_PATH REL_PATH ${CMAKE_CURRENT_LIST_DIR} ${DIR})

    string(REGEX MATCHALL "/" SLASHES "${REL_PATH}")
    list(LENGTH SLASHES DEPTH)
    math(EXPR DEPTH "${DEPTH} + 1")

    if(DEPTH EQUAL 1)
        set(RESOURCE_PREFIX "/qt/qml")
        qt_add_library(${DIR_NAME} STATIC)

        qt6_add_qml_module(${DIR_NAME}
            URI "${DIR_NAME}"
            VERSION 1.0
            RESOURCE_PREFIX ${RESOURCE_PREFIX}
            QML_FILES ${QML_FILES}
        )
    elseif(DEPTH EQUAL 2)
        get_filename_component(PARENT_DIR ${DIR} DIRECTORY)
        get_filename_component(PARENT_DIR_NAME ${PARENT_DIR} NAME)

        file(COPY ${DIR} DESTINATION ${CMAKE_BINARY_DIR}/qml/${PARENT_DIR_NAME})
    endif()
endforeach()
